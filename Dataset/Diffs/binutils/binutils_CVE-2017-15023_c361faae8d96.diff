diff --git a/bfd/ChangeLog b/bfd/ChangeLog
index 92a6c27ced8a..adbc014b5c16 100644
--- a/bfd/ChangeLog
+++ b/bfd/ChangeLog
@@ -1,3 +1,8 @@
+2017-09-25  Alan Modra  <amodra@gmail.com>
+
+	PR 22200
+	* dwarf2.c (read_formatted_entries): Error on format_count zero.
+
 2017-09-24  Alan Modra  <amodra@gmail.com>
 
 	PR 22197
diff --git a/bfd/dwarf2.c b/bfd/dwarf2.c
index 1566cd84b04e..8abb3f0b37ac 100644
--- a/bfd/dwarf2.c
+++ b/bfd/dwarf2.c
@@ -1933,6 +1933,13 @@ read_formatted_entries (struct comp_unit *unit, bfd_byte **bufp,
 
   data_count = _bfd_safe_read_leb128 (abfd, buf, &bytes_read, FALSE, buf_end);
   buf += bytes_read;
+  if (format_count == 0 && data_count != 0)
+    {
+      _bfd_error_handler (_("Dwarf Error: Zero format count."));
+      bfd_set_error (bfd_error_bad_value);
+      return FALSE;
+    }
+
   for (datai = 0; datai < data_count; datai++)
     {
       bfd_byte *format = format_header_data;

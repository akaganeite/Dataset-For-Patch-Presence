diff --git a/bfd/ChangeLog b/bfd/ChangeLog
index 450217a666cc..c465462bcaf3 100644
--- a/bfd/ChangeLog
+++ b/bfd/ChangeLog
@@ -1,3 +1,8 @@
+2017-09-24  Alan Modra  <amodra@gmail.com>
+
+	PR 22191
+	* dwarf2.c (decode_line_info): Properly free line sequences on error.
+
 2017-09-24  Alan Modra  <amodra@gmail.com>
 
 	PR 22187
diff --git a/bfd/dwarf2.c b/bfd/dwarf2.c
index ec4c311ec7b0..1566cd84b04e 100644
--- a/bfd/dwarf2.c
+++ b/bfd/dwarf2.c
@@ -2476,8 +2476,12 @@ decode_line_info (struct comp_unit *unit, struct dwarf2_debug *stash)
     return table;
 
  fail:
-  if (table->sequences != NULL)
-    free (table->sequences);
+  while (table->sequences != NULL)
+    {
+      struct line_sequence* seq = table->sequences;
+      table->sequences = table->sequences->prev_sequence;
+      free (seq);
+    }
   if (table->files != NULL)
     free (table->files);
   if (table->dirs != NULL)

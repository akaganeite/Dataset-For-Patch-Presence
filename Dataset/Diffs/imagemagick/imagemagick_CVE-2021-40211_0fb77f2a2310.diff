diff --git a/coders/emf.c b/coders/emf.c
index 2dc4c76e833..4941b6df63c 100644
--- a/coders/emf.c
+++ b/coders/emf.c
@@ -414,7 +414,7 @@ static HENHMETAFILE ReadEnhMetaFile(const char *path,ssize_t *width,
     }
   ReadFile(hFile,pBits,dwSize,&dwSize,NULL);
   CloseHandle(hFile);
-  if (((PAPMHEADER) pBits)->dwKey != 0x9ac6cdd7l)
+  if (((PAPMHEADER) pBits)->dwKey != 0x9ac6cdd7l || ((PAPMHEADER) pBits)->wInch == 0)
     {
       pBits=(BYTE *) DestroyString((char *) pBits);
       return((HENHMETAFILE) NULL);

diff --git a/coders/heic.c b/coders/heic.c
index f5db5964cde..6aee9b3e85d 100644
--- a/coders/heic.c
+++ b/coders/heic.c
@@ -340,26 +340,24 @@ static MagickBooleanType ReadHEICImageByID(const ImageInfo *image_info,
     (void) SetImageProperty(image,"exif:Orientation","1",exception);
   error=heif_decode_image(image_handle,&heif_image,heif_colorspace_YCbCr,
     heif_chroma_420,decode_options);
+  if (decode_options != (struct heif_decoding_options *) NULL)
+    heif_decoding_options_free(decode_options);
   if (IsHeifSuccess(&error,image,exception) == MagickFalse)
     {
       heif_image_handle_release(image_handle);
       return(MagickFalse);
     }
-  if (decode_options != (struct heif_decoding_options *) NULL)
+  /*
+    Correct the width and height of the image.
+  */
+  image->columns=(size_t) heif_image_get_width(heif_image,heif_channel_Y);
+  image->rows=(size_t) heif_image_get_height(heif_image,heif_channel_Y);
+  status=SetImageExtent(image,image->columns,image->rows,exception);
+  if (status == MagickFalse)
     {
-      /*
-        Correct the width and height of the image.
-      */
-      image->columns=(size_t) heif_image_get_width(heif_image,heif_channel_Y);
-      image->rows=(size_t) heif_image_get_height(heif_image,heif_channel_Y);
-      status=SetImageExtent(image,image->columns,image->rows,exception);
-      heif_decoding_options_free(decode_options);
-      if (status == MagickFalse)
-        {
-          heif_image_release(heif_image);
-          heif_image_handle_release(image_handle);
-          return(MagickFalse);
-        }
+      heif_image_release(heif_image);
+      heif_image_handle_release(image_handle);
+      return(MagickFalse);
     }
   p_y=heif_image_get_plane_readonly(heif_image,heif_channel_Y,&stride_y);
   p_cb=heif_image_get_plane_readonly(heif_image,heif_channel_Cb,&stride_cb);

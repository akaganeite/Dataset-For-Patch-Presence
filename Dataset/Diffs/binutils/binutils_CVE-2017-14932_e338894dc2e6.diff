diff --git a/bfd/ChangeLog b/bfd/ChangeLog
index 54199ad04295..5c4cc2bccd10 100644
--- a/bfd/ChangeLog
+++ b/bfd/ChangeLog
@@ -1,3 +1,9 @@
+2017-09-26  Alan Modra  <amodra@gmail.com>
+
+	PR 22204
+	* dwarf2.c (decode_line_info): Ensure line_ptr stays within
+	bounds in inner loop.
+
 2017-09-25  Alan Modra  <amodra@gmail.com>
 
 	PR 22202
diff --git a/bfd/dwarf2.c b/bfd/dwarf2.c
index 9ae5fba63790..2c457909356b 100644
--- a/bfd/dwarf2.c
+++ b/bfd/dwarf2.c
@@ -2277,7 +2277,7 @@ decode_line_info (struct comp_unit *unit, struct dwarf2_debug *stash)
       bfd_vma high_pc = 0;
 
       /* Decode the table.  */
-      while (! end_sequence)
+      while (!end_sequence && line_ptr < line_end)
 	{
 	  op_code = read_1_byte (abfd, line_ptr, line_end);
 	  line_ptr += 1;

diff --git a/coders/heic.c b/coders/heic.c
index 5e739af46be..47e4033262c 100644
--- a/coders/heic.c
+++ b/coders/heic.c
@@ -244,7 +244,7 @@ static MagickBooleanType ReadHEICExifProfile(Image *image,
       if ((length > 2) && 
           ((memcmp(datum,"\xff\xd8",2) == 0) ||
            (memcmp(datum,"\xff\xe1",2) == 0)) &&
-           memcmp(datum+length-2,"\xff\xd9",2) == 0)
+           (memcmp(datum+length-2,"\xff\xd9",2) == 0))
         SetStringInfoLength(exif_profile,length-2);
       /*
         Skip to actual Exif payload.
diff --git a/coders/jxl.c b/coders/jxl.c
index 504653873b6..8244f6f26a9 100644
--- a/coders/jxl.c
+++ b/coders/jxl.c
@@ -664,9 +664,15 @@ static Image *ReadJXLImage(const ImageInfo *image_info,ExceptionInfo *exception)
   if ((exif_profile != (StringInfo *) NULL) &&
       (GetStringInfoLength(exif_profile) > 4))
     {
+      size_t
+        exif_length;
+
       StringInfo
         *snippet;
 
+      unsigned char
+        *exif_datum;
+
       unsigned int
         offset=0;
 
@@ -682,19 +688,18 @@ static Image *ReadJXLImage(const ImageInfo *image_info,ExceptionInfo *exception)
       /*
         Strip any EOI marker if payload starts with a JPEG marker.
       */
-      size_t exif_length = GetStringInfoLength(exif_profile);
-      unsigned char *exif_datum = GetStringInfoDatum(exif_profile);
-      if (exif_length > 2 && 
-          (memcmp(exif_datum, "\xff\xd8", 2) == 0 ||
-           memcmp(exif_datum, "\xff\xe1", 2) == 0) &&
-          memcmp(exif_datum+exif_length-2, "\xff\xd9", 2) == 0)
-        SetStringInfoLength(exif_profile, exif_length-2);
+      exif_length=GetStringInfoLength(exif_profile);
+      exif_datum=GetStringInfoDatum(exif_profile);
+      if ((exif_length > 2) && 
+          ((memcmp(exif_datum,"\xff\xd8",2) == 0) ||
+           (memcmp(exif_datum,"\xff\xe1",2) == 0)) &&
+          (memcmp(exif_datum+exif_length-2,"\xff\xd9",2) == 0))
+        SetStringInfoLength(exif_profile,exif_length-2);
       /*
         Skip to actual Exif payload.
       */
       if (offset < GetStringInfoLength(exif_profile))
-        (void) DestroyStringInfo(SplitStringInfo(exif_profile,
-          offset));
+        (void) DestroyStringInfo(SplitStringInfo(exif_profile,offset));
       (void) SetImageProfile(image,"exif",exif_profile,exception);
       exif_profile=DestroyStringInfo(exif_profile);
     }
diff --git a/coders/tiff.c b/coders/tiff.c
index b93ca9c7347..2c1476ee233 100644
--- a/coders/tiff.c
+++ b/coders/tiff.c
@@ -1906,15 +1906,15 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,
         */
         strip_size=TIFFStripSize(tiff);
         stride=(ssize_t) TIFFVStripSize(tiff,1);
-        extent=(size_t) (samples_per_pixel*strip_size);
+        extent=(size_t) ((samples_per_pixel+extra_samples)*strip_size);
         length=GetQuantumExtent(image,quantum_info,quantum_type);
         if (length > stride)
           extent+=length;
         strip_pixels=(unsigned char *) AcquireQuantumMemory(extent,
-          sizeof(*strip_pixels));
+          sizeof(uint32));
         if (strip_pixels == (unsigned char *) NULL)
           ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
-        (void) memset(strip_pixels,0,extent*sizeof(*strip_pixels));
+        (void) memset(strip_pixels,0,extent*sizeof(uint32));
         strip_id=0;
         p=strip_pixels;
         for (i=0; i < (ssize_t) samples_per_pixel; i++)
